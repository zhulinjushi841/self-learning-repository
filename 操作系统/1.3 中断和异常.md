<!--
 * @Author: Jerome 841682441@qq.com
 * @Date: 2022-12-09 22:34:33
 * @LastEditors: Jerome 841682441@qq.com
 * @LastEditTime: 2022-12-11 21:53:58
 * @FilePath: \操作系统\1.3 中断和异常.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
## 1 中断和异常
发生中断就意味着需要操作系统介入，开展管理工作。

**2 中断的概念和作用**
1.当CPU发生的时候，CPU立即进入**核心态**。
2.当中断发生后，当前运行的进程暂停运行，并由操作系统内核对中断进行处理。
3.对于不同的中断信号，会进行不同的处理。

发生了中断，就意味着需要操作系统介入，开展管理工作。由于操作系统的管理工作(比如进程切换、分配I/O设备等)需要使用特权指令，因此CPU需要从用户态转为核心态。中断可以使得CPU从用户态切换为核心态，使得操作系统获得计算机的控制权。有了中断，才能实现多道程序并发执行。

**注意**
用户态——>核心态的切换是通过中断实现的，而且中断是唯一途径。
核心态——>用户态的切换是通过执行一个特权指令，将程序状态字(PSW)的标志位设置为"用户态"。

**3 中断的分类**
中断分为内中断和外中断。
其中内中断也叫做异常、例外、陷入等，其中又可以分为自愿中断(指令中断)和强制中断(包含硬件故障和软件中断)。

外中断(中断)包含有外设请求和人工干预。

两者的主要区别：内中断信号的来源是CPU的内部，与当前执行的指令有关。外中断信号的来源是CPU外部，与当前执行的指令无关。

**外中断的处理过程**
1.执行完每个指令之后，CPU都要检查当前是否有外部中断信号。
2.如果检测到外部中断信号，则需要保护被中断进程的CPU环境(如程序状态字PSW、程序计数器PC、各种通用寄存器)
3.根据中断信号类型转入相应的中断处理程序。
4.恢复原进程的CPU环境并退出中断，返回原进程并继续往下执行。




